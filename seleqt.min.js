!function(e,t,i,u){Array.prototype.indexOf||(Array.prototype.indexOf=function(e,t){for(var i=t||0,u=this.length;i<u;i++)if(this[i]===e)return i;return-1}),e.isSubstring=function(e,t){return-1!==e.indexOf(t)};var s,n=(s=0,function(e,t){clearTimeout(s),s=setTimeout(e,t)}),l=[{base:"A",letters:/[\u0041\u24B6\uFF21\u00C0\u00C1\u00C2\u1EA6\u1EA4\u1EAA\u1EA8\u00C3\u0100\u0102\u1EB0\u1EAE\u1EB4\u1EB2\u0226\u01E0\u00C4\u01DE\u1EA2\u00C5\u01FA\u01CD\u0200\u0202\u1EA0\u1EAC\u1EB6\u1E00\u0104\u023A\u2C6F]/g},{base:"AA",letters:/[\uA732]/g},{base:"AE",letters:/[\u00C6\u01FC\u01E2]/g},{base:"AO",letters:/[\uA734]/g},{base:"AU",letters:/[\uA736]/g},{base:"AV",letters:/[\uA738\uA73A]/g},{base:"AY",letters:/[\uA73C]/g},{base:"B",letters:/[\u0042\u24B7\uFF22\u1E02\u1E04\u1E06\u0243\u0182\u0181]/g},{base:"C",letters:/[\u0043\u24B8\uFF23\u0106\u0108\u010A\u010C\u00C7\u1E08\u0187\u023B\uA73E]/g},{base:"D",letters:/[\u0044\u24B9\uFF24\u1E0A\u010E\u1E0C\u1E10\u1E12\u1E0E\u0110\u018B\u018A\u0189\uA779]/g},{base:"DZ",letters:/[\u01F1\u01C4]/g},{base:"Dz",letters:/[\u01F2\u01C5]/g},{base:"E",letters:/[\u0045\u24BA\uFF25\u00C8\u00C9\u00CA\u1EC0\u1EBE\u1EC4\u1EC2\u1EBC\u0112\u1E14\u1E16\u0114\u0116\u00CB\u1EBA\u011A\u0204\u0206\u1EB8\u1EC6\u0228\u1E1C\u0118\u1E18\u1E1A\u0190\u018E]/g},{base:"F",letters:/[\u0046\u24BB\uFF26\u1E1E\u0191\uA77B]/g},{base:"G",letters:/[\u0047\u24BC\uFF27\u01F4\u011C\u1E20\u011E\u0120\u01E6\u0122\u01E4\u0193\uA7A0\uA77D\uA77E]/g},{base:"H",letters:/[\u0048\u24BD\uFF28\u0124\u1E22\u1E26\u021E\u1E24\u1E28\u1E2A\u0126\u2C67\u2C75\uA78D]/g},{base:"I",letters:/[\u0049\u24BE\uFF29\u00CC\u00CD\u00CE\u0128\u012A\u012C\u0130\u00CF\u1E2E\u1EC8\u01CF\u0208\u020A\u1ECA\u012E\u1E2C\u0197]/g},{base:"J",letters:/[\u004A\u24BF\uFF2A\u0134\u0248]/g},{base:"K",letters:/[\u004B\u24C0\uFF2B\u1E30\u01E8\u1E32\u0136\u1E34\u0198\u2C69\uA740\uA742\uA744\uA7A2]/g},{base:"L",letters:/[\u004C\u24C1\uFF2C\u013F\u0139\u013D\u1E36\u1E38\u013B\u1E3C\u1E3A\u0141\u023D\u2C62\u2C60\uA748\uA746\uA780]/g},{base:"LJ",letters:/[\u01C7]/g},{base:"Lj",letters:/[\u01C8]/g},{base:"M",letters:/[\u004D\u24C2\uFF2D\u1E3E\u1E40\u1E42\u2C6E\u019C]/g},{base:"N",letters:/[\u004E\u24C3\uFF2E\u01F8\u0143\u00D1\u1E44\u0147\u1E46\u0145\u1E4A\u1E48\u0220\u019D\uA790\uA7A4]/g},{base:"NJ",letters:/[\u01CA]/g},{base:"Nj",letters:/[\u01CB]/g},{base:"O",letters:/[\u004F\u24C4\uFF2F\u00D2\u00D3\u00D4\u1ED2\u1ED0\u1ED6\u1ED4\u00D5\u1E4C\u022C\u1E4E\u014C\u1E50\u1E52\u014E\u022E\u0230\u00D6\u022A\u1ECE\u0150\u01D1\u020C\u020E\u01A0\u1EDC\u1EDA\u1EE0\u1EDE\u1EE2\u1ECC\u1ED8\u01EA\u01EC\u00D8\u01FE\u0186\u019F\uA74A\uA74C]/g},{base:"OI",letters:/[\u01A2]/g},{base:"OO",letters:/[\uA74E]/g},{base:"OU",letters:/[\u0222]/g},{base:"P",letters:/[\u0050\u24C5\uFF30\u1E54\u1E56\u01A4\u2C63\uA750\uA752\uA754]/g},{base:"Q",letters:/[\u0051\u24C6\uFF31\uA756\uA758\u024A]/g},{base:"R",letters:/[\u0052\u24C7\uFF32\u0154\u1E58\u0158\u0210\u0212\u1E5A\u1E5C\u0156\u1E5E\u024C\u2C64\uA75A\uA7A6\uA782]/g},{base:"S",letters:/[\u0053\u24C8\uFF33\u1E9E\u015A\u1E64\u015C\u1E60\u0160\u1E66\u1E62\u1E68\u0218\u015E\u2C7E\uA7A8\uA784]/g},{base:"T",letters:/[\u0054\u24C9\uFF34\u1E6A\u0164\u1E6C\u021A\u0162\u1E70\u1E6E\u0166\u01AC\u01AE\u023E\uA786]/g},{base:"TZ",letters:/[\uA728]/g},{base:"U",letters:/[\u0055\u24CA\uFF35\u00D9\u00DA\u00DB\u0168\u1E78\u016A\u1E7A\u016C\u00DC\u01DB\u01D7\u01D5\u01D9\u1EE6\u016E\u0170\u01D3\u0214\u0216\u01AF\u1EEA\u1EE8\u1EEE\u1EEC\u1EF0\u1EE4\u1E72\u0172\u1E76\u1E74\u0244]/g},{base:"V",letters:/[\u0056\u24CB\uFF36\u1E7C\u1E7E\u01B2\uA75E\u0245]/g},{base:"VY",letters:/[\uA760]/g},{base:"W",letters:/[\u0057\u24CC\uFF37\u1E80\u1E82\u0174\u1E86\u1E84\u1E88\u2C72]/g},{base:"X",letters:/[\u0058\u24CD\uFF38\u1E8A\u1E8C]/g},{base:"Y",letters:/[\u0059\u24CE\uFF39\u1EF2\u00DD\u0176\u1EF8\u0232\u1E8E\u0178\u1EF6\u1EF4\u01B3\u024E\u1EFE]/g},{base:"Z",letters:/[\u005A\u24CF\uFF3A\u0179\u1E90\u017B\u017D\u1E92\u1E94\u01B5\u0224\u2C7F\u2C6B\uA762]/g},{base:"a",letters:/[\u0061\u24D0\uFF41\u1E9A\u00E0\u00E1\u00E2\u1EA7\u1EA5\u1EAB\u1EA9\u00E3\u0101\u0103\u1EB1\u1EAF\u1EB5\u1EB3\u0227\u01E1\u00E4\u01DF\u1EA3\u00E5\u01FB\u01CE\u0201\u0203\u1EA1\u1EAD\u1EB7\u1E01\u0105\u2C65\u0250]/g},{base:"aa",letters:/[\uA733]/g},{base:"ae",letters:/[\u00E6\u01FD\u01E3]/g},{base:"ao",letters:/[\uA735]/g},{base:"au",letters:/[\uA737]/g},{base:"av",letters:/[\uA739\uA73B]/g},{base:"ay",letters:/[\uA73D]/g},{base:"b",letters:/[\u0062\u24D1\uFF42\u1E03\u1E05\u1E07\u0180\u0183\u0253]/g},{base:"c",letters:/[\u0063\u24D2\uFF43\u0107\u0109\u010B\u010D\u00E7\u1E09\u0188\u023C\uA73F\u2184]/g},{base:"d",letters:/[\u0064\u24D3\uFF44\u1E0B\u010F\u1E0D\u1E11\u1E13\u1E0F\u0111\u018C\u0256\u0257\uA77A]/g},{base:"dz",letters:/[\u01F3\u01C6]/g},{base:"e",letters:/[\u0065\u24D4\uFF45\u00E8\u00E9\u00EA\u1EC1\u1EBF\u1EC5\u1EC3\u1EBD\u0113\u1E15\u1E17\u0115\u0117\u00EB\u1EBB\u011B\u0205\u0207\u1EB9\u1EC7\u0229\u1E1D\u0119\u1E19\u1E1B\u0247\u025B\u01DD]/g},{base:"f",letters:/[\u0066\u24D5\uFF46\u1E1F\u0192\uA77C]/g},{base:"g",letters:/[\u0067\u24D6\uFF47\u01F5\u011D\u1E21\u011F\u0121\u01E7\u0123\u01E5\u0260\uA7A1\u1D79\uA77F]/g},{base:"h",letters:/[\u0068\u24D7\uFF48\u0125\u1E23\u1E27\u021F\u1E25\u1E29\u1E2B\u1E96\u0127\u2C68\u2C76\u0265]/g},{base:"hv",letters:/[\u0195]/g},{base:"i",letters:/[\u0069\u24D8\uFF49\u00EC\u00ED\u00EE\u0129\u012B\u012D\u00EF\u1E2F\u1EC9\u01D0\u0209\u020B\u1ECB\u012F\u1E2D\u0268\u0131]/g},{base:"j",letters:/[\u006A\u24D9\uFF4A\u0135\u01F0\u0249]/g},{base:"k",letters:/[\u006B\u24DA\uFF4B\u1E31\u01E9\u1E33\u0137\u1E35\u0199\u2C6A\uA741\uA743\uA745\uA7A3]/g},{base:"l",letters:/[\u006C\u24DB\uFF4C\u0140\u013A\u013E\u1E37\u1E39\u013C\u1E3D\u1E3B\u017F\u0142\u019A\u026B\u2C61\uA749\uA781\uA747]/g},{base:"lj",letters:/[\u01C9]/g},{base:"m",letters:/[\u006D\u24DC\uFF4D\u1E3F\u1E41\u1E43\u0271\u026F]/g},{base:"n",letters:/[\u006E\u24DD\uFF4E\u01F9\u0144\u00F1\u1E45\u0148\u1E47\u0146\u1E4B\u1E49\u019E\u0272\u0149\uA791\uA7A5]/g},{base:"nj",letters:/[\u01CC]/g},{base:"o",letters:/[\u006F\u24DE\uFF4F\u00F2\u00F3\u00F4\u1ED3\u1ED1\u1ED7\u1ED5\u00F5\u1E4D\u022D\u1E4F\u014D\u1E51\u1E53\u014F\u022F\u0231\u00F6\u022B\u1ECF\u0151\u01D2\u020D\u020F\u01A1\u1EDD\u1EDB\u1EE1\u1EDF\u1EE3\u1ECD\u1ED9\u01EB\u01ED\u00F8\u01FF\u0254\uA74B\uA74D\u0275]/g},{base:"oi",letters:/[\u01A3]/g},{base:"ou",letters:/[\u0223]/g},{base:"oo",letters:/[\uA74F]/g},{base:"p",letters:/[\u0070\u24DF\uFF50\u1E55\u1E57\u01A5\u1D7D\uA751\uA753\uA755]/g},{base:"q",letters:/[\u0071\u24E0\uFF51\u024B\uA757\uA759]/g},{base:"r",letters:/[\u0072\u24E1\uFF52\u0155\u1E59\u0159\u0211\u0213\u1E5B\u1E5D\u0157\u1E5F\u024D\u027D\uA75B\uA7A7\uA783]/g},{base:"s",letters:/[\u0073\u24E2\uFF53\u00DF\u015B\u1E65\u015D\u1E61\u0161\u1E67\u1E63\u1E69\u0219\u015F\u023F\uA7A9\uA785\u1E9B]/g},{base:"t",letters:/[\u0074\u24E3\uFF54\u1E6B\u1E97\u0165\u1E6D\u021B\u0163\u1E71\u1E6F\u0167\u01AD\u0288\u2C66\uA787]/g},{base:"tz",letters:/[\uA729]/g},{base:"u",letters:/[\u0075\u24E4\uFF55\u00F9\u00FA\u00FB\u0169\u1E79\u016B\u1E7B\u016D\u00FC\u01DC\u01D8\u01D6\u01DA\u1EE7\u016F\u0171\u01D4\u0215\u0217\u01B0\u1EEB\u1EE9\u1EEF\u1EED\u1EF1\u1EE5\u1E73\u0173\u1E77\u1E75\u0289]/g},{base:"v",letters:/[\u0076\u24E5\uFF56\u1E7D\u1E7F\u028B\uA75F\u028C]/g},{base:"vy",letters:/[\uA761]/g},{base:"w",letters:/[\u0077\u24E6\uFF57\u1E81\u1E83\u0175\u1E87\u1E85\u1E98\u1E89\u2C73]/g},{base:"x",letters:/[\u0078\u24E7\uFF58\u1E8B\u1E8D]/g},{base:"y",letters:/[\u0079\u24E8\uFF59\u1EF3\u00FD\u0177\u1EF9\u0233\u1E8F\u00FF\u1EF7\u1E99\u1EF5\u01B4\u024F\u1EFF]/g},{base:"z",letters:/[\u007A\u24E9\uFF5A\u017A\u1E91\u017C\u017E\u1E93\u1E95\u01B6\u0225\u0240\u2C6C\uA763]/g}],a=function(e){var t;t||(t=l);for(var i=0;i<t.length;i++)e=e.replace(t[i].letters,t[i].base);return e};jQuery.extend({highlight:function(e,t,u,s){if(3===e.nodeType){var n=a(e.data).match(t);if(n){var l=i.createElement(u||"span");l.className=s||"highlight";var o=e.splitText(n.index);o.splitText(n[0].length);var r=o.cloneNode(!0);return l.appendChild(r),o.parentNode.replaceChild(l,o),1}}else if(1===e.nodeType&&e.childNodes&&!/(script|style)/i.test(e.tagName)&&(e.tagName!==u.toUpperCase()||e.className!==s))for(var c=0;c<e.childNodes.length;c++)c+=jQuery.highlight(e.childNodes[c],t,u,s);return 0}}),jQuery.fn.unhighlight=function(e){var t={className:"highlight",element:"span"};return jQuery.extend(t,e),this.find(t.element+"."+t.className).each(function(){var e=this.parentNode;e.replaceChild(this.firstChild,this),e.normalize()}).end()},jQuery.fn.highlight=function(e,t){var i={className:"highlight",element:"span",caseSensitive:!1,wordsOnly:!1};if(jQuery.extend(i,t),(e=a(e)).constructor===String&&(e=[e]),e=jQuery.grep(e,function(e,t){return""!=e}),0==(e=jQuery.map(e,function(e,t){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")})).length)return this;var u=i.caseSensitive?"":"i",s="("+e.join("|")+")";i.wordsOnly&&(s="\\b"+s+"\\b");var n=new RegExp(s,u);return this.each(function(){jQuery.highlight(this,n,i.element,i.className)})},i.querySelectorAll||(i.querySelectorAll=function(e){var u,s=i.createElement("style"),n=[];for(i.documentElement.firstChild.appendChild(s),i._qsa=[],s.styleSheet.cssText=e+"{x-qsa:expression(document._qsa && document._qsa.push(this))}",t.scrollBy(0,0),s.parentNode.removeChild(s);i._qsa.length;)(u=i._qsa.shift()).style.removeAttribute("x-qsa"),n.push(u);return i._qsa=null,n}),i.querySelector||(i.querySelector=function(e){var t=i.querySelectorAll(e);return t.length?t[0]:null});var o={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isArrow:function(e){switch(e=e.which?e.which:e){case o.LEFT:case o.RIGHT:case o.UP:case o.DOWN:return!0}return!1},isControl:function(e){switch(e.which){case o.SHIFT:case o.CTRL:case o.ALT:return!0}return!!e.metaKey},isFunctionKey:function(e){return(e=e.which?e.which:e)>=112&&e<=123}},r="seleqt";function c(t,i){this.elem=t,this.$elem=e(t),this.$elem_original=this.$elem,this.options=i,this.multiple=!1,this.selected=[],this.multiple_options=[],this.page=1,this.allLoaded=!1,this.metadata=this.$elem.data(),this._init()}c.prototype={defaults:{formatResult:function(e){return e.text},data:!1,ajaxUrl:!1,cache:!0,searchAllowed:!0,maxInputLength:256,minInputLength:0,maxSelectionSize:!1,multiple:!1,infiniteScroll:!0,limit:20,allowClear:!0,placeHolder:!1,animation:"faded",message:"Hello world!"},lang:{textSelectAll:function(){return"Select all"},textDeselectAll:function(){return"Cancel all selected"},textSelectAllInGroup:function(){return"Select all in group"},textCancelSelection:function(){return"Cancel selected item"},textLoading:function(){return"Loading items..."},textLoadMore:function(){return"Load more"},textListEnd:function(){return"End of the list"},textInputTooShort:function(e,t){var i=t-e.length;return"Please enter "+i+" or more character"+(1==i?"":"s")},textInputTooLong:function(e){var t="The searching string can only have "+e+" character";return e>1&&(t+="s"),t},textNotClassified:function(){return"Not classified"},textNoMatches:function(){return"No matches found"},textSearching:function(){return"Searching..."},textSelectionTooBig:function(e){return"You can only select "+e+" item"+(1==e?"":"s")},textSelectResult:function(){return"Select from the list..."},textResultsToSelect:function(e){return 1==e?"item to select":"items to select"}},_init:function(){return this.config=e.extend({},this.defaults,this.options,this.metadata),this.lang=e.extend({},this.lang,e.fn.seleqt.lang),this.config.placeHolder||(this.config.placeHolder=this.lang.textSelectResult()),this.config.ajaxUrl||(this.allLoaded=!0),this._transformElement(),this._initEvents(),this},_parseInt:function(e){var t=parseInt(e);return t||!1},_transformElement:function(){var t=this,i=this.$elem.prop("tagName");this.tag=i;this.getRemoveTag();this.multiple=!!(this.$elem.data("multiple")||this.config.multiple||this.$elem.attr("multiple"));var s=!1,n=this.$elem.attr("name")!=u?this.$elem.attr("name"):"";if("INPUT"===i){s=this.$elem.data("val");var l="",a=""}else{var o="option";if("UL"==i&&(o="li"),this.multiple){var r=[];this.$elem.find("option").each(function(){e(this).attr("selected")&&r.push({text:e(this).text(),id:e(this).val()})}),r&&(s=r)}else{l="",a="";if("UL"==i){a=this.$elem.data("selected");var c=this.$elem.find('li[data-value="'+a+'"]');l=c.find("a").length?this.$elem.find('li[data-value="'+a+'"]').find("a").html():this.$elem.find('li[data-value="'+a+'"]').html()}else this.$elem.find(o).each(function(){if("UL"==i){if(e(this).data("selected")){var t=e(this).find("a").length;l=t?e(this).find("a").html():e(this).html(),a=e(this).val()}}else e(this).attr("selected")&&(l=e(this).text(),a=e(this).val())});s=[{id:a,text:l}]}}var h=e("<div class='seleqt'></div>"),d="";d+="<div class='area'>",this.multiple,d+=this._initSelection(s,n),d+="<div class='options_cached'></div>",d+="</div>";var p=h.html(d),f="<div class='seleqt_wrapper' style='position:relative'>",g=e(f+="</div>");e(this.$elem).wrapAll(g),this.$elem.closest(".seleqt_wrapper").append(p),this.$elem.css("width","1px"),this.$elem.css("height","1px"),this.$elem.css("position","absolute"),this.$elem.css("left","0");var E="";if(this.multiple?E=this.multiple_options:s&&s.data&&s.data[0]&&s.data[0].id&&(E=s.data[0].id),E=E.toString(),this.$elem_original.closest(".seleqt_wrapper").find(".input").attr("name",n),this.setSelected(E),"SELECT"==i||"UL"==i){o="option";"UL"==i&&(o="li");var m=this.$elem.find(o).length,v="";t.$elem.find("optgroup").length;if(m){var A={},F=(p=0,0);this.$elem.find(o).length;this.$elem.find(o).each(function(s){if("UL"==i)var n=e(this).data("value"),l=e(this).html();else n=e(this).attr("value"),l=e(this).text();0!==e(this).closest("optgroup").length?(F=e(this).closest("optgroup").index()+1,v=e(this).closest("optgroup").attr("label")):(F=0,v=t.lang.textNotClassified()),A[F]==u&&(A[F]={}),A[F].label=v,A[F].options==u&&(A[F].options={}),A[F].options[p]={id:n,text:l},p+=1});var C=t.createOptions(A,!1);h.find(".options_cached").append(C)}}var $=h.find(".input"),_=(this.$elem.attr("id"),n=this.$elem.attr("name"),this.$elem.attr("class"));if(e.each(this.$elem.data(),function(e,t){}),n&&$.attr("name",n),_){var b=_.split(" ");for(p=0;p<b.length;p++);}this.$elem=h,this.seleqt=this.$elem},setSelected:function(e){e=e.toString(),this.$elem_original.val(e),this.$elem_original.data("selected",e)},getSelected:function(){return this.$elem_original.data("selected")},_isEqual:function(e,t){return""!==e&&""!==t&&e===t},_initSelection:function(e,t){var i="";if(this.multiple){i+="<div class='selected_options' data-id=''>";var s=this.createSelectedOptions(e.data);s?(n=this.multiple_options,i+=s):i+=this.noneSelectedLabel(),i+="</div>"}else{var n,l;if(e&&e.data&&e.data[0])n=e.data[0].id,l=e.data[0].text;if(i+="<div class='text_wrap'>",i+="<div class='text' data-id='"+n+"'>",l)i+=this.createOption(e.data[0],e);else i+=this.noneSelectedLabel();i+="</div>",i+="</div>",l&&(i+=this.getRemoveTag())}return i+="<div class='open'> <div class='openicon'><i class='icon icon-down-open'></i></div> </div>",n==u&&(n=""),i},_initEvents:function(){var t=this,u=this.$elem,s=this.$elem.find(".text");this.$elem_original.on("focusin",function(){t.$elem.css("border","1px solid black")}),this.$elem_original.on("focusout",function(){t.$elem.css("border","0px")});var l,r,c=!1;this.$elem.on("touchmove",".options li",function(e){c=!0}),this.$elem.on("mousedown",".options li",function(e){e.preventDefault()}),this.$elem.on("touchend mouseup",".options li",function(i){if(c)c=!1;else{var n=u.find(".text").data("id"),l=e(this).data("id"),a=e(this).html(),o=s,r=l,h=!1;if(l!==n){if(t.multiple)h=t.selectOption(e(this)),r=t.multiple_options;else{h=!0,o.html(a),o.data("id",l);var d=t.getRemoveTag();t.$elem.find(".remove").length||t.$elem.find(".open").after(d)}h&&t.triggerChange(r)}t.multiple||t.close(),c=!1}}),e(i).on("click",".seleqt",function(e){e.stopPropagation()}),e(i).on("click",function(i){e(".seleqt").each(function(){e(this).hasClass("opened")&&t.close(e(this))})}),this.$elem.on("click",".area, input",function(i){i.stopPropagation(),e(".seleqt").not(t.$elem).each(function(){e(this).hasClass("opened")&&t.close(e(this))});var u=e(this).prop("tagName"),s=t.$elem.hasClass("opened");"INPUT"==u?s||t.open(!1):s?t.close():t.open()}),this.$elem.on("keyup",".input_search input",function(i){if(o.isArrow(i.which))return!1;if((l=u.find(".input_search input").val()).length>t.config.maxInputLength)return l=l.substring(0,l.length-1),e(this).val(l),void t.showMsg(t.lang.textInputTooLong(t.config.maxInputLength));if(l.length<t.config.minInputLength){if(t.showMsg(t.lang.textInputTooShort(l,t.config.minInputLength)),8!=i.which)return;l=""}var s=0;t.allLoaded&&t.config.cache||(s=500),n(function(){t.config.cache||(t.page=1),t.$elem.find(".get_more").data("page",1),l=a(l).toLowerCase(),r=t.getOptions(l,1),t.showOptions(r,!1),t.$elem.find(".options li").unhighlight(),t.$elem.find(".options li").highlight(l)},s)}),this.$elem.on("click",".remove",function(i){i.stopPropagation(),t.$elem.find(".text").data("id",""),t.$elem.find(".text").html(t.noneSelectedLabel()),e(this).remove(),t.triggerChange("")}),this.$elem.on("click",".remove_selected_option",function(i){i.stopPropagation();var u=e(this).closest(".selected_option");t.removeSelectedOption(u),n(function(){t.triggerChange(t.multiple_options)},400)}),this.$elem.on("click",".select_all_in_group",function(i){if(t.multiple){var u=0;e(this).closest(".optgroup").find("li").each(function(){if(!t.selectOption(e(this)))return!1;u++}),u&&t.triggerChange(t.multiple_options)}}),this.$elem.on("click",".select_all",function(i){if(i.stopPropagation(),t.multiple){var u=0;t.$elem.find(".options li").each(function(){if(!e(this).hasClass("hidden")){if(!t.selectOption(e(this)))return!1;u++}}),u&&t.triggerChange(t.multiple_options)}}),this.$elem.on("click",".deselect_all",function(i){i.stopPropagation(),t.multiple&&(t.$elem.find(".selected_options .selected_option").each(function(){t.removeSelectedOption(e(this))}),n(function(){t.triggerChange(t.multiple_options)},400))}),this.$elem.on("click",".get_more",function(e){e.stopPropagation(),t._getMoreResults()}),this.$elem.on("click",".go_top",function(e){e.stopPropagation(),t.$elem.find(".options_inner").animate({scrollTop:0},300)}),this.$elem.on("click",".msg_ok",function(t){t.stopPropagation(),e(this).closest(".msg").remove()})},_getMoreResults:function(){var e=this;if(e.allLoaded)return console.log("_getMoreResults"),!1;var t=e.$elem.find(".get_more"),i=e.$elem.find(".options .get_more"),u=i.html();if(!i.hasClass("end")){i.html("<i class='icon icon-spin icon-spinner'></i> "+e.lang.textLoading()),e.$elem.find(".options").data("loading",1);var s=t.data("page"),n=e.$elem.find(".input_search input").val();n?(s?s++:(s=2,t.data("page",2)),t.data("page",s)):(e.page=e.page+1,s=e.page);var l=e._ajax(n,s),a=e.createOptions(l,!0,!1);t.closest(".options").find("li:not(.hidden)").length?e.$elem.find(".options").find("li:last").after(a):i.before(a),e.config.animation,i.html(u),l&&l[0].options.length<e.config.limit&&(i.addClass("end").html(e.lang.textListEnd()+" <span class='go_top'><i class='icon icon-up-circled'></i></span>"),!n&&e.config.cache&&(e.allLoaded=!0)),e.config.cache&&!n&&e.$elem.find(".options_cached").html(e.$elem.find(".options").html()),e.$elem.unhighlight(),e.$elem.highlight(n),e.refreshSelectionStatuses(),e.$elem.find(".options").data("loading",0)}},removeSelectedOption:function(t){var i=this;t.data("id");t.fadeOut(300,function(){var t=e(this).data("id");e(this).remove();var u=i.multipleOptionExist(t);!1!==u&&i.multiple_options.splice(u,1);i.$elem.find(".options").find("[data-id='"+t+"']").closest(".optgroup").removeClass("hidden"),i.$elem.find(".options").find("[data-id='"+t+"']").removeClass("hidden");i.$elem.find(".selected_options .selected_option").length||i.$elem.find(".selected_options").html(i.noneSelectedLabel())})},triggerChange:function(t){var i=this;i.$elem.find(".options li:not(.hidden)").length<=0&&(i.$elem.find(".input_search input").val(""),i.$elem.find(".input_search input").trigger(e.Event("keyup",{keycode:8,which:8})),i.$elem.find(".input_search input").focus()),i.setSelected(t),i.$elem_original.trigger("change"),i.refreshSelectionStatuses(),i.config.animation},getRemoveTag:function(){var e="";if(this.config.allowClear)e="<div class='remove'> <i class='icon icon-cancel-1' title='"+this.lang.textCancelSelection()+"'></i> </div>";return e},multipleOptionExist:function(e){e=e.toString();var t=this.multiple_options.indexOf(e);return-1!==t&&t},showMsg:function(t,i){i||!1===i||(i=!0);var u="";u+="<div class='msg'>",u+="<div class='msg_wrap'>",u+="<div class='msg_text'> "+t+"</div>",u+="<div class='msg_foot'> <div class='msg_ok'>OK</div></div>",u+="</div>",u+="</div>";var s=this.$elem.find(".options_wrapper .msg").length;this.$elem.find(".options_wrapper .msg").remove(),this.$elem.find(".options_wrapper").append(u),s||this.$elem.find(".options_wrapper .msg").hide().fadeIn(300),i&&this.$elem.find(".options_wrapper .msg").fadeOut(4e3,function(){e(this).remove()})},selectOption:function(t){if(this.config.maxSelectionSize&&this.config.maxSelectionSize<=this.multiple_options.length)return this.showMsg(this.lang.textSelectionTooBig(this.config.maxSelectionSize)),!1;var i=this,u=t.data("id"),s=t.text(),n=i.multipleOptionExist(u);if(i._isEqual(n,!1)){i.hideOption(t);var l=e(i.createSelectedOption(u,s));i.$elem.find(".selected_options").append(l),l.hide().fadeIn(300),i.$elem.find(".none_selected").length&&i.$elem.find(".none_selected").remove()}return!0},hideOption:function(e){var t=e.data("id");t=t.toString();this.$elem.find(".options_cached").find("[data-id='"+t+"']").addClass("hidden");e.addClass("hidden");e.closest("div").find("li").length,e.closest("div").find("li.hidden").length;var i=e.closest(".options").find("li").length;e.closest(".options").find("li.hidden").length>=i&&this.noResults()},noneSelectedLabel:function(){return"<div class='none_selected'>"+this.config.placeHolder+"</div>"},getCookie:function(e){for(cName="",pCOOKIES=new Array,pCOOKIES=i.cookie.split("; "),bb=0;bb<pCOOKIES.length;bb++)NmeVal=new Array,NmeVal=pCOOKIES[bb].split("="),NmeVal[0]==e&&(cName=unescape(NmeVal[1]));return cName},_ajax:function(t,i){i||(i=this.page);var u=this.getCookie("csrfprotect");location.href.split("?")[1];if(!s)var s={};s.csrfname=u,s.page_id=e("#page").data("id"),s.field=this.$elem.find(".input").data("elid"),s.q=t,s.page=i,s.limit=this.config.limit;var n=e("#page").data("id"),l=this.$elem.find(".input").data("elid"),a=t,o={},r=!1,c="",h={},d=this.config.ajaxUrl;d=d+"?q="+a+"&page_id="+n+"&field="+l;var p,f=!1;return this.config.ajaxUrl&&e.ajax({type:"GET",url:d,scriptCharset:"UTF-8",async:!1,data:s,dataType:"json",success:function(e){e.data&&(o=e.data,r=e.data.results,c=e.data.tpl,h=e.data.li_batch)},error:function(e,t,i){f=i,r=!1}}),f&&this.showMsg(f,!1),r&&((p={})[0]={},p[0].tpl=c,p[0].li_batch=h,p[0].label="none",p[0].options=r,p[0].data=o),p},getOptions:function(t,i){var u=this;t||(t="");var s=this.$elem.find(".options_cached li").length,n=this.$elem.find(".options_cached .get_more").length;if(s&&(!t||!n||this.allLoaded)){var l="";this.$elem.find(".options_cached").find("li").each(function(i){var s=e(this).data("id");if(!u.multiple||!1===u.multipleOptionExist(s)){l=a(e(this).text()).toLowerCase(),e.isSubstring(l,t)?e(this).removeClass("hidden"):e(this).addClass("hidden");var n=e(this).closest("div").find("li").length;e(this).closest("div").find("li.hidden").length>=n?e(this).closest("div").addClass("hidden"):e(this).closest("div").removeClass("hidden")}});return(this.$elem.find(".options_cached li.hidden").length>=s||u.allLoaded)&&this.$elem.find(".get_more").hide(),h=this.$elem.find(".options_cached").html()}if(this.config.data){u.allLoaded=!0;var o=this.config.data;if(o)(r={0:{}})[0].label="none",r[0].options=o}else{this.$elem.find(".input_search input").before("<div class='loading'><i class='icon icon-spin icon-spinner'></i></div>");var r=u._ajax(t,i)}var c=u.createOptions(r);r&&!this.config.data&&this.config.limit<=r[0].options.length&&(c+="<div class='get_more'> <i class='icon icon-plus'></i> "+u.lang.textLoadMore()+"</div>");var h=this.$elem.find(".options_cached li").length;this._isEqual(h,0)&&(!this.config.cache&&this.config.ajaxUrl||this.$elem.find(".options_cached").append(c)),this.$elem.find(".loading").remove();return c},createOptions:function(e,t,i){var u="";t||!1===t||(t=!0),i||!1===i||(i=!0);var s,n,l,a,o,r,c={},h=[],d=0;for(key in e)d++;if(0==d)u+=this.noResults();else for(key in e){if(e[key],s=e[key].label,n=e[key].options,r=e[key].tpl,l=e[key].li_batch,c=e[key].data,i&&(u+="<div class='optgroup optgroup"+key+"'>"),d>1&&(u+="<p>"+s,this.multiple&&(u+=" <i class='icon icon-list-add select_all_in_group' title='"+this.lang.textSelectAllInGroup()+"'></i>"),u+="</p>"),l)u+=l;else for(key2 in n)a=n[key2].id,o=n[key2].text,h.push(a),o=this.config.formatResult(n[key2]),u+=this.createOption(n[key2],c,a,o,void 0,t,r);i&&(u+="</div>")}return u},createOption:function(t,i,u,s,n,l){if(!t)return"";if(i||(i={}),tpl=i.tpl,l||!1===l||(l=!0),n||!0===n||(n=!1),!t.id)return"";t.text||(t.text="ID: "+t.id);var a="";this.multiple&&(!1!==this.multipleOptionExist(t.id)&&(a="class='hidden'"));if(tpl)e(tpl),o=tpl;else{tpl=t.text;var o=" <li "+a+"data-id='"+t.id+"' >"+tpl+"</li>"}var r=(new Date).getTime();return o=(o=(o=(o=(o=(o=o.replace("{$text}",t.text)).replace("{$suffix}",t.suffix+"?"+r)).replace("{$id}",t.id)).replace("{$icon}",t.icon)).replace("{$path}",i.image_path)).replace("{$image}","<img />")},createSelectedOptions:function(e){var t,i,u="";if(e)for(j=0;j<e.length;j++)t=e[j].id,i=e[j].text,u+=this.createSelectedOption(t,i);return u},createSelectedOption:function(e,t){if(!(e=e.toString())||!t)return"";this.multiple_options.push(e);var i="<div class='selected_option' data-id='"+e+"'>";return i+="<div class='remove_selected_option'>",i+="<i class='icon icon-cancel-1'></i>",i+="</div>",i+="<div class='option_text'>"+t+"</div>",i+="</div>"},showOptions:function(e,t){var i=this;if(e)u=e;else var u="";t||!1===t||(t=!0),u&&(t?this.$elem.find(".options").html(u).hide().fadeIn(200,function(){i.$elem.find(".options li").length}):this.$elem.find(".options").html(u)),this.config.infiniteScroll||this.$elem.find(".get_more").addClass("hidden"),this.refreshSelectionStatuses(),this.$elem.find(".options").find("img").length>0&&this.$elem.find(".options").find("img").load(function(){i.refreshSelectionStatuses()})},refreshSelectionStatuses:function(){var i=this.$elem.find(".options li:not(.hidden)").length,u=this.$elem.find(".selected_options .selected_option").length;i<=0||this.config.maxSelectionSize&&u>=this.config.maxSelectionSize?this.$elem.find(".select_all").addClass("hidden"):this.$elem.find(".select_all").removeClass("hidden"),this.config.maxSelectionSize&&this.config.maxSelectionSize-u<i?this.$elem.find(".select_all .count").html(this.config.maxSelectionSize-u):this.$elem.find(".select_all .count").html(i),this.$elem.find(".deselect_all .count").html(u),u>0?this.$elem.find(".deselect_all").removeClass("hidden"):this.$elem.find(".deselect_all").addClass("hidden"),this.$elem.find(".deselect_all");this.$elem.find(".search_info .search_text").html(this.lang.textResultsToSelect(i));this.$elem.find(".search_info .count_items").html(i);var s=this.$elem.find(".options li").length,n=this.$elem.find(".options li.hidden").length,l=this.$elem.find(".options .no_data").length,a=(this.$elem.find(".options").height(),this.$elem.find(".options li").height(),0);if(this.$elem.find(".options li").each(function(){a+=e(this).outerHeight()}),a<=250?this.$elem.find(".options_inner").css("overflow-y","none"):this.$elem.find(".options_inner").css("overflow-y","scroll"),n>=s){if(!l){var o=this.noResults();this.$elem.find(".options").append(o)}}else l&&this.$elem.find(".options").find(".no_data").remove();this.$elem.find(".options").find(".optgroup").each(function(){var t=e(this).find("li").length;e(this).find("li.hidden").length>=t&&e(this).addClass("hidden")});var r=e(t),c={top:r.scrollTop(),left:r.scrollLeft()};c.right=c.left+r.width(),c.bottom=c.top+r.height();var h=this.$elem.offset();h.right=h.left+this.$elem.outerWidth(),h.bottom=h.top+this.$elem.outerHeight();var d=h.top-c.top,p=c.bottom-h.bottom,f=this.$elem.find(".resultbox").height()+this.$elem.find(".area").height()+2;p>=d||h.top<=f?this.$elem.find(".resultbox").css("margin-top","-1px"):this.$elem.find(".resultbox").css("margin-top",-f)},noResults:function(){return"<div class='no_data'>"+this.lang.textNoMatches()+"</div>"},open:function(t){var u=this;this.config.cache||(this.page=1),this.$elem.css("z-index","999"),this.$elem.addClass("opened"),this.$elem.find(".open .icon").removeClass("icon-down-open").addClass("icon-up-open");var s="";s+="<div class='resultbox'>",this.config.searchAllowed&&(s+="<div class='input_search'>",s+="<div class='input_wrap'>",s+="<div class='search'><i class='icon icon-search-1'></i></div>",s+="<input type='text' maxlength='"+(this.config.maxInputLength+1)+"' />",s+="<div class='search_info'>",s+="<span class='count_items'></span> ",s+="<span class='search_text'>"+this.lang.textSearching()+"</span> ",this.multiple&&(s+="<span class='select_deselect'>",s+="<span class='select_all hidden' title='"+this.lang.textSelectAll()+"'>",s+="<i class='icon icon-plus-squared'></i>",s+="<span class='count'>",s+="0",s+="</span>",s+="</span>",s+="<span class='deselect_all hidden' title='"+this.lang.textDeselectAll()+"'>",s+="<i class='icon icon-minus-squared'></i>",s+="<span class='count'>",s+="0",s+="</span>",s+="</span>",s+="</span>"),s+="</div>",s+="</div>",s+="</div>");var n="";if(this.config.animation&&(n=" "+this.config.animation),s+="<div class='options_wrapper'>",s+="<ul class='options_inner"+n+"'>",s+="<div class='options'>",s+="</div>",s+="</ul>",s+="</div>",(s=e(s+="</div>")).appendTo(this.$elem),this.$elem.find(".input_search input").focus(),this.config.infiniteScroll){i.querySelectorAll(".options_inner")[0].onscroll=function(){var t=e(this).scrollTop()+250,i=e(this).find(".options").innerHeight(),s=u.$elem.find(".options").data("loading");t+1>=i&&1!=s&&u._getMoreResults()}}var l=this.getOptions();this.showOptions(l)},close:function(e){e||(e=this.$elem),e.css("z-index","998"),e.removeClass("opened"),e.find(".open .icon").removeClass("icon-up-open").addClass("icon-down-open"),e.find(".resultbox").remove(),this.$elem.unhighlight()},test:function(){alert("testing")}},e.fn[r]=function(t){var i,s=arguments;return t===u||"object"==typeof t?this.each(function(){e.data(this,"plugin_"+r)||e.data(this,"plugin_"+r,new c(this,t))}):"string"==typeof t&&"_"!==t[0]&&"init"!==t?(this.each(function(){var u=e.data(this,"plugin_"+r);u instanceof c&&"function"==typeof u[t]&&(i=u[t].apply(u,Array.prototype.slice.call(s,1))),"destroy"===t&&e.data(this,"plugin_"+r,null)}),i!==u?i:this):void 0}}(jQuery,window,document);
